!function t(e,i,n){function a(s,o){if(!i[s]){if(!e[s]){var h="function"==typeof require&&require;if(!o&&h)return h(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){var i=e[s][1][t];return a(i?i:t)},u,u.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(t,e,i){t("../element/register.js");e.exports=function(){function t(){e.width=i.naturalWidth,e.height=i.naturalHeight,this.width(e.width),this.height(e.height),i.parentNode.insertBefore(e,i),i.parentNode.removeChild(i),Martin.registerElement("image",function(t){drawImage.call(this,t)}),this.image(i)}if(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.newLayer(),this.original)if("IMG"===this.original.tagName){var e=this.canvas,i=(this.context,this.original);if(i.complete)return t.call(this);i.onload=t.bind(this)}else"CANVAS"===this.original.tagName&&(this.canvas=this.original,this.context=this.original.getContext("2d"));return this.autorender(),this}},{"../element/register.js":3}],2:[function(t,e,i){function n(t,e,i){var n=e.base||e,a=e.currentLayer||e;return this.base=n,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=n.original?n.original.naturalWidth||n.original.width:n.width(),this.canvas.height=n.original?n.original.naturalHeight||n.original.height:n.height(),this.scale={x:1,y:1},this.data=i||{},i.x&&(this.data.x=a.normalizeX(i.x)),i.y&&(this.data.y=a.normalizeY(i.y)),this.type=t,this.layer=a,this.effects=[],this.stack=this.layer.elements,this.stack.push(this),"background"===this.type&&(this.data={color:i},this.bumpToBottom()),this}var a=t("../object/object.js");n.prototype=Object.create(a.prototype),n.prototype.setContext=function(t){var e=this.context;e.save(),e.fillStyle=t.color||"#000",e.fill(),e.scale(this.scale.x,this.scale.y),e.globalAlpha=t.alpha||1,e.lineWidth=t.strokeWidth?t.strokeWidth:0,e.lineCap=t.cap?t.cap:"square",e.strokeStyle=t.stroke?t.stroke:"transparent",e.stroke(),e.restore()},n.prototype.update=function(t,e){var i,n;if(e)i=t,n=e,this.data[i]=n;else for(i in t)n=t[i],this.data[i]=n;this.base.autorender()},n.prototype.moveTo=function(t,e){var i=this.data;return t=t||0,e=e||0,"line"===this.type?(i.endX+=t-i.x,i.endY+=e-i.y):"polygon"===this.type&&(i.points.forEach(function(n,a){if(a>0){var r=n[0],s=n[1];i.points[a]=[r+(t-i.points[0][0]),s+(e-i.points[0][1])]}}),i.points[0]=[t,e]),i.x=t,i.y=e,this.base.autorender(),this},e.exports=n},{"../object/object.js":5}],3:[function(t,e,i){var n=t("./init.js");e.exports=function(t,e){function i(i){var a=new n(t,this,i);return a.renderElement=function(){var t=this.layer,i=this.context;this.clear(),i.scale(t.scale.x,t.scale.y),i.beginPath(),e.call(a,this.data),this.setContext(this.data),i.closePath(),i.scale(1/t.scale.x,1/t.scale.y),Martin.utils.forEach(this.effects,function(t){t.renderEffect&&t.renderEffect()}),t.context.drawImage(this.canvas,0,0)},a}Martin.prototype[t]=function(t){var e=i.call(this,t);return this.autorender(),e},Martin.Layer.prototype[t]=function(t){var e=i.call(this.base,t);return this.base.autorender(),e}}},{"./init.js":2}],4:[function(t,e,i){var n=function(t,e){return this instanceof n?(this.original=null,"string"==typeof t?this.original=document.getElementById(t):t instanceof HTMLElement&&(this.original=t),this.options=e||{},this.makeCanvas()):new n(t,e)};n.prototype.makeCanvas=t("./core/init.js");var a={};for(var r in a)for(var s in a[r])"_private"===type?n.utils[s]=a[r][s]:n.prototype[s]=a[r][s];"object"==typeof window&&(window.Martin=n),e.exports=n},{"./core/init.js":1}],5:[function(t,e,i){var n=function(){};n.prototype.loop=function(t,e){var i,n,a,r,s,o,h,c,u,l,p,f,d=this.base.width();this.base.height();if(i=this.getImageData()){n=i.data,a=n.length;for(var g=0;a>g;g+=4)r=g/4,s=r%d,o=Math.floor(r/d),h=n[g],c=n[g+1],u=n[g+2],l=n[g+3],p={r:h,g:c,b:u,a:l},f=t.call(this.context,s,o,p),n[g]=f.r,n[g+1]=f.g,n[g+2]=f.b,n[g+3]=f.a;e!==!1&&this.putImageData(i)}return this},n.prototype.getImageData=function(){var t=this.context&&this.canvas.width>0&&this.canvas.height>0?this.context.getImageData(0,0,this.canvas.width,this.canvas.height):null;return t},n.prototype.putImageData=function(t){return this.context.putImageData(t,0,0),this},n.prototype.clear=function(){return this.context.clearRect(0,0,this.base.width(),this.base.height()),this},n.prototype.stackIndex=function(){return this.stack.indexOf(this)},n.prototype.remove=function(){return this.stack.splice(this.stackIndex(),1),this.base.autorender(),this},n.prototype.bump=function(t){var e=this.stackIndex();return this.remove(),this.stack.splice(e+t,0,this),this.base.autorender(),this},n.prototype.bumpUp=function(){return this.bump(1)},n.prototype.bumpDown=function(){return this.bump(-1)},n.prototype.bumpToTop=function(){return this.remove(),this.stack.push(this),this.base.autorender(),this},n.prototype.bumpToBottom=function(){return this.remove(),this.stack.unshift(this),this.base.autorender(),this},e.exports=n},{}]},{},[4]);