Martin.registerEffect("gradientMap",function(r){function t(r){var t;return"#"===r.charAt(0)&&(r=r.slice(1)),3===r.length&&(r=r.split(""),r.splice(2,0,r[2]),r.splice(1,0,r[1]),r.splice(0,0,r[0]),r=r.join("")),t={r:parseInt(r[0]+r[1],16),g:parseInt(r[2]+r[3],16),b:parseInt(r[4]+r[5],16)}}var n=t(r.start),e=t(r.end);this.currentLayer.loop(function(r,t,a){return a.r=Math.round(n.r+a.r/256*(e.r-n.r)),a.g=Math.round(n.g+a.g/256*(e.g-n.g)),a.b=Math.round(n.b+a.b/256*(e.b-n.b)),a})});